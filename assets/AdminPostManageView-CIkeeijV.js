import{_ as S}from"./MyInput-Df35YVUj.js";import{I as N,_ as R,a as z,b as L}from"./FileUploader-B3Ul-OnD.js";import{p as T,r as y,q as j,c as n,o as s,a as e,f as C,t as g,s as w,x as W,y as q,_ as K,F as I,g as M,n as O,z as Z,P as D,B as G,m as H,h as J,i as b,j as P,d as Q,l as X,u as Y,k as ee,A as te,C as F}from"./index-vb3ZeOfp.js";const le={class:"flex flex-col items-center bg-base-300 p-4 rounded-xl shadow shadow-primary"},se={key:0,class:"text-lg font-bold"},ae={class:"mt-2"},ne=["src"],oe={class:"flex gap-6 mt-2"},ie={__name:"ImageUploader",props:T({btnTitle:{type:String,default:"Select Image"},maxW:{type:Number,default:200},title:{type:String,default:"Upload Image"}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(d){const v=d,f=y(null),t=y(null),x=r=>{const m=r.target.files[0],c=new FileReader;c.readAsDataURL(m),c.onload=k=>{t.value=k.target.result}},_=()=>{t.value=null};return j(d,"modelValue"),(r,m)=>(s(),n("div",le,[e("div",null,[d.title?(s(),n("h3",se,g(d.title),1)):C("",!0)]),e("div",ae,[t.value?(s(),n("img",{key:0,style:W(d.maxW?`max-width:${d.maxW}px`:""),class:"mx-auto w-full",src:t.value,alt:""},null,12,ne)):(s(),w(N,{key:1,class:"text-primary w-full"}))]),e("div",oe,[e("input",{accept:".png, .jpg",onChange:x,class:"hidden",ref_key:"inputFile",ref:f,type:"file"},null,544),e("button",{onClick:m[0]||(m[0]=c=>f.value.click()),class:"btn btn-secondary"},g(v.btnTitle),1),t.value?(s(),n("button",{key:0,onClick:_,class:"btn btn-warning"},"Remove")):C("",!0)])]))}},de={class:"container mx-auto p-6 bg-base-200 rounded-xl"},ue={class:"text-3xl text-base-content font-bold"},re={class:"mt-10"},U={__name:"ContentCard",props:{title:String},setup(d){const v=d;return(f,t)=>(s(),n("div",de,[e("h2",ue,g(v.title),1),e("div",re,[q(f.$slots,"default",{class:"mt-10"})])]))}},ce={},me={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"};function pe(d,v){return s(),n("svg",me,v[0]||(v[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"},null,-1)]))}const ve=K(ce,[["render",pe]]),fe={class:"breadcrumbs text-sm p-4 font-bold"},_e=["onClick"],be={key:1},xe={class:"flex flex-col gap-4"},ge={class:"flex gap-4 sm:gap-8 items-center"},ye={class:"text-xl font-bold"},ke={class:"text-lg font-bold"},he={class:"flex gap-2 items-center"},Ve=["onClick"],Ce={__name:"CategorySelector",props:T({selectMode:{default:!1},btnOpen:{default:!1},btnSelect:{default:!1},btnDelete:{default:!1},btnDefault:{default:!0}},{modelValue:{},modelModifiers:{}}),emits:T(["select","open","edit","delete"],["update:modelValue"]),setup(d,{expose:v,emit:f}){const t=y([]),x=y([]),_=y(0),r=y([]),m=f,c=j(d,"modelValue"),k=d;k.btnDefault==!1?(r.value=[],k.btnSelect&&r.value.push({title:"Select",id:"select",class:"btn-info"}),k.btnOpen&&r.value.push({title:"Open",id:"open",class:"btn-info"}),k.btnDelete&&r.value.push({title:"Delete",id:"delete",class:"btn-error"})):r.value=[{title:"Open",id:"open",class:"btn-info"},{title:"Edit",id:"edit"},{title:"Delete",id:"delete",class:"btn-error"}];const p=(o,u)=>{u.id=="edit"?m("edit",o):u.id=="open"?(m("open",o),l(o)):u.id=="select"?(m("select",o),c.value=o.id):u.id=="delete"&&m("delete",o)},l=(o,u)=>{_.value=o.id,$()},$=(o="parent")=>{let u={};o=="parent"?u={parent:_.value}:u={id:c.value},console.log("getCategorylistByParent",u),D("category/list-by-parent",u).then(i=>{i.ok&&(t.value=i.list,x.value=i.tree)})},a=o=>c.value==o.id?"bg-teal-100":"";return v({loadById:o=>{c.value=o,Z(()=>{$("id")})},loadMain:()=>{_.value=0,$()}}),(o,u)=>(s(),n("div",null,[e("div",null,[e("div",fe,[e("ul",null,[e("li",null,[e("a",{onClick:u[0]||(u[0]=i=>l({id:0}))},"Main")]),(s(!0),n(I,null,M(x.value,(i,B)=>(s(),n("li",{key:i.id},[B+1<x.value.length?(s(),n("a",{key:0,onClick:V=>l(i)},g(i.title),9,_e)):(s(),n("span",be,g(i.title),1))]))),128))])])]),e("div",xe,[(s(!0),n(I,null,M(t.value,(i,B)=>(s(),n("div",{key:B,class:O([[a(i)],"flex gap-4 justify-between bg-base-100 rounded-xl p-4 shadow"])},[e("div",ge,[e("div",ye,g(i.title),1),e("div",ke,g(i.link),1)]),e("div",he,[i.id==c.value?(s(),w(ve,{key:0,class:"text-green-500 size-10"})):C("",!0),(s(!0),n(I,null,M(r.value,(V,E)=>(s(),n("button",{onClick:Fe=>p(i,V),class:O(["btn btn-outline",V==null?void 0:V.class]),key:E},g(V.title),11,Ve))),128))])],2))),128))])]))}},$e={class:"flex gap-4"},we={class:"flex-1"},Se={class:"mb-4"},Pe={class:"mb-4"},Ie={class:"border bg-black/10 p-2 rounded-xl"},Me={class:"mb-4"},Be={class:"flex gap-4 mt-6 flex justify-center"},Ue={class:"mb-4"},Te={class:"mb-4"},De={class:"mb-4"},Ae={class:"flex items-center justify-between mt-16"},Oe={class:"flex items-center gap-4 md:gap-8"},Re={__name:"AdminPostManageView",setup(d){const v=Q(),f=J(),t=y({}),x=y(null),_=y([]);G(()=>t.value.title,(p,l)=>{t.value.link=t.value.title.replaceAll(" ","-")});const r=p=>{const l=new Date().getTime();_.value.push({id:l,type:p})},m=()=>{t.value.contents=_.value,D("post/save",{post:t.value}).then(p=>{p.ok?F({text:"Success",icon:"success"}).then(async()=>{await v.replace({name:"admin_post_edit",params:{id:p.post_id}}),c()}):F({text:p.message,icon:"error"})})},c=()=>{const p=f.params.id;D("post/info",{id:p}).then(l=>{l.ok&&(t.value=l.post,_.value=l.post.contents,x.value.loadById(t.value.category_id))})},k=()=>({api_token:te.getApiToken()});return H(()=>{f.name=="admin_post_edit"?c():x.value.loadMain()}),(p,l)=>{const $=X("router-link");return s(),n("div",null,[b(U,{title:"Create New Post"},{default:P(()=>[e("div",$e,[e("div",we,[e("div",Se,[b(S,{modelValue:t.value.title,"onUpdate:modelValue":l[0]||(l[0]=a=>t.value.title=a),title:"Title","title-class":"font-bold text-base-content text-xl","input-class":"input-primary"},null,8,["modelValue"])]),e("div",Pe,[b(S,{modelValue:t.value.link,"onUpdate:modelValue":l[1]||(l[1]=a=>t.value.link=a),title:"Link","title-class":"font-bold text-base-content text-xl","input-class":"input-primary"},null,8,["modelValue"])]),e("div",Ie,[l[9]||(l[9]=e("div",null,[e("h3",{class:"text-xl font-bold"},"Select Category")],-1)),b(Ce,{ref_key:"categoryComponent",ref:x,"btn-default":!1,"select-mode":!1,"btn-open":!0,"btn-select":!0,modelValue:t.value.category_id,"onUpdate:modelValue":l[2]||(l[2]=a=>t.value.category_id=a)},null,8,["modelValue"])])]),e("div",null,[b(R,{"upload-url":"admin/post/upload-image","upload-params":k(),title:"Featured photo",class:"w-72",modelValue:t.value.image,"onUpdate:modelValue":l[3]||(l[3]=a=>t.value.image=a)},null,8,["upload-params","modelValue"])])])]),_:1}),b(U,{title:"Content",class:"mt-8"},{default:P(()=>[e("div",Me,[(s(!0),n(I,null,M(_.value,(a,h)=>(s(),n("div",{key:h,class:"mb-4"},[a.type=="richbox"?(s(),w(z,{key:0,title:"Text Content","com-id":a.id,modelValue:a.content,"onUpdate:modelValue":A=>a.content=A},null,8,["com-id","modelValue","onUpdate:modelValue"])):C("",!0),a.type=="image"?(s(),w(ie,{key:1,"max-w":"400"})):C("",!0)]))),128)),e("div",Be,[e("button",{onClick:l[4]||(l[4]=a=>r("richbox")),class:"btn btn-secondary"},"Add Richbox"),e("button",{onClick:l[5]||(l[5]=a=>r("image")),class:"btn btn-secondary"},"Add Image")])])]),_:1}),b(U,{title:"SEO Fields",class:"mt-8"},{default:P(()=>{var a;return[e("div",Ue,[b(S,{modelValue:t.value.meta_title,"onUpdate:modelValue":l[6]||(l[6]=h=>t.value.meta_title=h),"title-class":"font-bold text-xl text-base-content ","input-class":"input-primary",title:"SEO Title"},null,8,["modelValue"])]),e("div",Te,[b(L,{modelValue:t.value.meta_description,"onUpdate:modelValue":l[7]||(l[7]=h=>t.value.meta_description=h),"title-class":"font-bold text-base-content text-xl","textarea-class":"textarea-primary",title:"SEO Description"},null,8,["modelValue"])]),e("div",De,[b(S,{modelValue:t.value.meta_keywords,"onUpdate:modelValue":l[8]||(l[8]=h=>t.value.meta_keywords=h),"title-class":"font-bold text-base-content text-xl","input-class":"input-primary",title:"SEO Keywords"},null,8,["modelValue"])]),e("div",Ae,[e("div",Oe,[e("button",{onClick:m,class:"btn btn-primary px-12 btn-lg",type:"submit"},g(Y(f).name=="admin_post_edit"?"Save post":"Create Post"),1),(a=t.value)!=null&&a.title?(s(),w($,{key:0,class:"btn btn-secondary btn-lg",target:"_blank",to:{name:"post_view",params:{id:t.value.id,title:t.value.link}}},{default:P(()=>l[10]||(l[10]=[ee("Preview")])),_:1},8,["to"])):C("",!0)])])]}),_:1})])}}};export{Re as default};
